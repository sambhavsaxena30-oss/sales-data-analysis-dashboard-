<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sales Performance Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap & Chart.js CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  
    <style>
        html {
            scroll-behavior: smooth;
        }

        body {
            background-color: #f4f6f8;
            font-family: 'Segoe UI', sans-serif;
            color: #333;
        }

        h1, h4 {
            color: #1d3557;
        }

        .container {
            max-width: 960px;
            margin: auto;
        }

        .chart-section {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            padding: 40px;
            margin-bottom: 50px;
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            box-shadow: 0 4px 25px rgba(0,0,0,0.1);
        }

        canvas {
            max-width: 100%;
            height: 70vh !important;
        }

        .btn-primary {
            background-color: #457b9d;
            border-color: #457b9d;
        }

        .btn-primary:hover {
            background-color: #1d3557;
        }

        table {
            background-color: white;
        }

        footer {
            text-align: center;
            padding: 20px;
            color: #999;
        }

        .table thead th {
    background-color: #1d3557;
    color: white;
    text-align: center;
    vertical-align: middle;
}

.table td, .table th {
    text-align: center;
    vertical-align: middle;
}

    </style>
</head>
<body class="p-4">

<div class="container">
    <h1 class="mb-4 text-center">üìä Sales Performance Dashboard</h1>

    <!-- Upload Form -->
    <form method="POST" enctype="multipart/form-data" class="mb-5">
        <input type="file" name="csvfile" class="form-control mb-3" required>
        <button type="submit" class="btn btn-primary w-100">Upload CSV</button>
    </form>

    <!-- Display Data -->
    {% if data %}
        <hr>
        <h3>üßæ First 5 Rows of Data</h3>
        <table class="table table-bordered table-striped">
            <thead>
            <tr>
                {% for col in columns %}
                <th>{{ col }}</th>
                {% endfor %}
            </tr>
            </thead>
            <tbody>
            {% for row in data %}
            <tr>
                {% for item in row %}
                <td>{{ item }}</td>
                {% endfor %}
            </tr>
            {% endfor %}
            </tbody>
        </table>

        <h3>üìà Summary Statistics</h3>
        <div class="mb-5">{{ summary | safe }}</div>

        <!-- Chart Sections -->
        <section class="chart-section">
            <h4>üìä Bar Chart: Units Sold per Product</h4>
            <p>This helps compare how each product performed in sales volume.</p>
            <canvas id="barChart"></canvas>
        </section>

        <section class="chart-section">
            <h4>ü•ß Pie Chart: Revenue by Category</h4>
            <p>This shows which category generated the highest revenue.</p>
            <canvas id="pieChart"></canvas>
        </section>

        <section class="chart-section">
            <h4>üåç Region-wise Revenue</h4>
            <p>This tells us which region performed best in terms of revenue.</p>
            <canvas id="regionChart"></canvas>
        </section>

        <section class="chart-section">
            <h4>üìÜ Revenue Over Time (Monthly Trend)</h4>
            <p>This line chart helps identify growth and decline in revenue across months.</p>
            <canvas id="lineChart"></canvas>
        </section>
    {% endif %}
</div>

<footer>
    &copy; 2023 | Created by Ashritha üíª
</footer>

<!-- JS: Chart Render -->
<script>
    const chartData = {{ chart_data | tojson }};

    new Chart(document.getElementById('barChart'), {
        type: 'bar',
        data: {
            labels: chartData.product_labels,
            datasets: [{
                label: 'Units Sold',
                data: chartData.units_sold,
                backgroundColor: '#4e79a7'
            }]
        },
        options: {
            responsive: true,
            plugins: {
                title: {
                    display: true,
                    text: 'Units Sold per Product'
                }
            }
        }
    });

    new Chart(document.getElementById('pieChart'), {
        type: 'pie',
        data: {
            labels: chartData.category_labels,
            datasets: [{
                data: chartData.category_values,
                backgroundColor: ['#f28e2b', '#e15759', '#76b7b2', '#59a14f']
            }]
        },
        options: {
            plugins: {
                title: {
                    display: true,
                    text: 'Revenue by Category'
                }
            }
        }
    });

    new Chart(document.getElementById('regionChart'), {
        type: 'bar',
        data: {
            labels: chartData.region_labels,
            datasets: [{
                label: 'Revenue',
                data: chartData.region_values,
                backgroundColor: '#ff9f40'
            }]
        },
        options: {
            plugins: {
                title: {
                    display: true,
                    text: 'Revenue by Region'
                }
            }
        }
    });

    new Chart(document.getElementById('lineChart'), {
        type: 'line',
        data: {
            labels: chartData.monthly_labels,
            datasets: [{
                label: 'Monthly Revenue',
                data: chartData.monthly_values,
                borderColor: '#8cd17d',
                fill: false
            }]
        },
        options: {
            plugins: {
                title: {
                    display: true,
                    text: 'Monthly Revenue Trend'
                }
            }
        }
    });
</script>

</body>
</html>
